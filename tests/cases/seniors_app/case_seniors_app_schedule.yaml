# CXTB-10: Full Schedule display
TestVerifyFullScheduleDisplay:
  Environment: Settings
  Precases:
    - LoginNeverAloneHelper
  Aftercases:
    - TerminateApp
  Roles:
    - Role: localiOS
      App: NeverAlone
    - Role: desktopChrome
      Capabilities:
        chromeOptions:
          args:
            - use-fake-ui-for-media-stream
            - use-fake-device-for-media-stream
            - no-sandbox
            - disable-gpu
      App: desktop    
  Actions:
  # Set up past event on Care Platform.
    - Type: case
      Value: SetPastEventForSeniors
    - Type: click
      Strategy: class_chain
      Id: $PAGE.seniors_app_appointment_modal.close_btn$
      Condition:
      - Value: 5
        Operation: visible
        Result: true
  # iPad steps started now.
  # Navigate to the Schedule page.
    - Type: click
      Strategy: class_chain
      Id: $PAGE.seniors_app_home.full_schedule_btn$
    - Type: get_timestamp
      Format: "%A %B %-d"
      Var: TODAY_DATE
  # Verify that the Full Schedule page loaded as expected.
    - Type: return_element_attribute
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.schedule_date_label$
      Attribute: value
      ResultVar: TODAY_DATE_SCHEDULE
    - Type: assert
      Asserts:
        - Type: contain
          Var: TODAY_DATE_SCHEDULE
          Value: $AND_CLI_TODAY_DATE$
    # Click on the left arrow and verify that the date changes and the page updates to show the day prior.
    - Type: click
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.left_arrow_schedule$
    - Type: get_yesterday_date
      Format: "%A %B %-d"
      Var: YESTERDAY_DATE
    - Type: return_element_attribute
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.schedule_date_label$
      Attribute: value
      ResultVar: YESTERDAY_DATE_SCHEDULE
    - Type: assert
      Asserts:
        - Type: contain
          Var: YESTERDAY_DATE_SCHEDULE
          Value: $AND_CLI_YESTERDAY_DATE$
      # Click on the right arrow twice and verify that the date changes and the page updates to show the day prior.
    - Type: click
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.right_arrow_schedule$
    - Type: click
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.right_arrow_schedule$
    - Type: get_tomorrow_date
      Format: "%A %B %-d"
      Var: TOMORROW_DATE
    - Type: return_element_attribute
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.schedule_date_label$
      Attribute: value
      ResultVar: TOMORROW_DATE_SCHEDULE
    - Type: assert
      Asserts:
        - Type: contain
          Var: TOMORROW_DATE_SCHEDULE
          Value: $AND_CLI_TOMORROW_DATE$
    # Click the button "Today" and veirfy that page refreshed, showing todayâ€™s date and schedule.
    - Type: click
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.today_btn$
    - Type: return_element_attribute
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.schedule_date_label$
      Attribute: value
      ResultVar: TODAY_DATE_SCHEDULE
    - Type: assert
      Asserts:
        - Type: contain
          Var: TODAY_DATE_SCHEDULE
          Value: $AND_CLI_TODAY_DATE$
    # Verify that any event that is over has moved to the bottom of the list.
    - Type: verify_event_went_to_bottom
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.events_elements$
      EventName: $AND_CLI_UNIQUE_EVENT_NAME$

# CXTB-12: Schedules Page Navigation
TestSchedulesPageNavigation:
  Environment: Settings
  Precases:
    - LoginNeverAloneHelper
  Roles:
    - Role: localiOS
      App: NeverAlone
  Actions:
  # In the Home page, click on the button "Full Schedule" and verify user is redirected to Schedules page.
    - Type: case
      Value: SchedulesPageNavigationHelper
  # Terminate the app.
    - Type: case
      Value: TerminateApp

# CXTB-39: Automatically Return to Full Schedule Page After Period of Inactivity
TestAutomaticReturnAfterInactivty:
  Environment: Settings
  Precases:
    - LoginNeverAloneHelper
  Aftercases:
    - TerminateApp
  Roles:
    - Role: localiOS
      Capabilities:
        newCommandTimeout: 310
      App: NeverAlone
    - Role: desktopChrome
      App: desktop 
  Actions:
  # Set up an appointment for the senior.
    - Type: case
      Value: SetScheduledCallForSeniors
  # In the Home page, click on the button "Full Schedule" and verify user is redirected to Schedules page.
    - Type: case
      Value: SchedulesPageNavigationHelper
  # Click an event in the listing.
    - Type: click
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.first_event$
  # Event details view should be displayed.
    - Type: wait_for
      Strategy: class_chain
      Id: $PAGE.seniors_app_appointment_modal.appointment_header_modal$
  # Wait for 5 minutes without performing any actions.
    - Type: sleep
      Time: 300
  # Schedules page should be displayed.
    - Type: wait_for
      Strategy: class_chain
      Id: $PAGE.seniors_app_schedule.schedule_label$